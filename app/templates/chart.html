{% extends "base.html" %}

{% block title %}Chart JS Demo{% endblock %}

{% block css %}
<style type="text/css">
  canvas {
    padding-top: 50px;
  }
</style>
{% endblock %}


{% block content %}
<h1>Student Age Distribution</h1>
<canvas id="myChart" width="680" height="400"></canvas>
{% endblock %}


{% block js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/0.2.0/Chart.min.js"></script>

<script>
  $(document).ready(function() {

    $.ajax({
      type: 'GET',
      url: '{{ url_for("views.get_graph_data") }}',
      dataType: 'json',
      complete: function(data){
        var age_distribution = data.responseJSON.age_distribution;
        var graph_data = {
          labels : [],
          datasets : [
            {
              fillColor : "rgba(151,187,205,0.5)",
              strokeColor : "rgba(151,187,205,1)",
              data : []
            }
          ]
        };
        for(var age_group in age_distribution) {
          if(age_distribution.hasOwnProperty(age_group)){
            graph_data.labels.push(age_group);
            graph_data.datasets[0].data.push(age_distribution[age_group]);
          }
        }

        var ctx = $("#myChart").get(0).getContext("2d");
        var options = {
        };

        var myNewChart = new Chart(ctx).Bar(graph_data,options);
      }
    });


  });
</script>

{% endblock %}